"use strict";(self.webpackChunkethan_desktop=self.webpackChunkethan_desktop||[]).push([[19],{3674:(S,l,c)=>{c.r(l),c.d(l,{ToDoApp:()=>b,ToDoModule:()=>L});var g=c(5615),d=c(1977),m=c(4004),u=c(727),t=c(4650),f=c(9238),M=c(1859),h=c(7169),C=c(2485),a=c(6895),D=c(8805),O=c(9593),T=c(1068),P=c(7345);function v(e,_){1&e&&t._UZ(0,"e-empty",7)}const x=function(e,_){return{expired:e,checked:_}};function A(e,_){if(1&e){const o=t.EpF();t.TgZ(0,"div",11),t.NdJ("click",function(){const s=t.CHM(o).$implicit,r=t.oxw(3);return t.KtG(r.editToDo(s))})("mouseup",function(n){const r=t.CHM(o).$implicit,p=t.oxw(3);return t.KtG(p.onItemMouseUp(n,r))}),t.TgZ(1,"i",12),t.NdJ("click",function(n){const r=t.CHM(o).$implicit,p=t.oxw(3);return n.stopPropagation(),t.KtG(p.changeStatus(r))}),t.qZA(),t.TgZ(2,"div",13)(3,"div",14),t._uU(4),t.qZA(),t.TgZ(5,"div",15),t._uU(6),t.ALo(7,"dateFixer"),t.qZA()()()}if(2&e){const o=_.$implicit;t.Q6J("ngClass",t.WLB(7,x,o.expired,"checked"==o.status)),t.xp6(1),t.Q6J("icon","default"==o.status?"circle":"check_circle"),t.xp6(3),t.Oqu(o.title),t.xp6(2),t.Oqu(t.xi3(7,4,o.date,"HH:mm"))}}function E(e,_){if(1&e&&(t.TgZ(0,"div",8)(1,"div",9)(2,"b"),t._uU(3),t.ALo(4,"dateFixer"),t.qZA()(),t.YNc(5,A,8,10,"div",10),t.qZA()),2&e){const o=_.$implicit;t.xp6(3),t.Oqu(t.xi3(4,2,o.date,"yyyy/MM/dd")),t.xp6(2),t.Q6J("ngForOf",o.items)}}function y(e,_){if(1&e){const o=t.EpF();t.TgZ(0,"div",2)(1,"h2",3)(2,"b"),t._uU(3,"\u5f85\u529e\u4e8b\u9879"),t.qZA(),t.TgZ(4,"i",4),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.editToDo())}),t.qZA()(),t.YNc(5,v,1,0,"e-empty",5),t.YNc(6,E,6,5,"div",6),t.qZA()}if(2&e){const o=t.oxw();t.xp6(5),t.Q6J("ngIf",!o.toDoListArray.length),t.xp6(1),t.Q6J("ngForOf",o.toDoListArray)}}let b=(()=>{class e{constructor(o,i,n,s){this.EAS=o,this.todoSrv=i,this.modalSrv=n,this.EMS=s,this.menu=[{name:"\u5f85\u529e\u4e8b\u9879",children:[]}],this.titleBarConfig={showTitle:!1,showBorder:!1},this.subscription=new u.w0,this.editing=!1,this.EAS.setAppActionBarMenu("toDo",this.menu)}ngOnInit(){this.getToDoList()}ngAfterViewInit(){(0,d.gw)(()=>{this.subscription.add(this.EAS.eAppConfigChange.subscribe(o=>{"toDo"==o.id&&o.config?.event&&(0,d.gw)(()=>{"add"===o.config.event&&this.editToDo(o.config?.data)})}))},1e3),this.subscription.add(this.EAS.eAppStatusChange.subscribe(o=>{"toDo"==o.id&&this.getToDoList()}))}ngOnDestroy(){this.subscription.unsubscribe()}getToDoList(){this.todoSrv.getToDoList().subscribe(o=>{this.setToDoListArray(o.data)})}setToDoListArray(o){let i=[];for(let n in o){let s=o[n];i.push({date:new Date(Number(n)),items:s})}this.toDoListArray=i}editToDo(o){if(this.editing)return;this.editing=!0;let i={};o&&(i={title:o.title,date:(0,d.p6)(o.date,"yyyy/MM/dd HH:mm")},o.id&&(i.id=o.id)),this.modalSrv.ef({title:(o?.id?"\u7f16\u8f91":"\u65b0\u589e")+"\u5f85\u529e\u4e8b\u9879",efConfig:{formData:i,schema:{id:{widget:"hidden"},title:{title:"\u4e3b\u9898",widget:"input",placeholder:"\u8bf7\u8f93\u5165\u4e3b\u9898",validator:n=>(0,d.QF)(n)?[]:["\u8bf7\u8f93\u5165\u4e3b\u9898"]},date:{title:"\u65f6\u95f4",widget:"date",placeholder:"\u8bf7\u9009\u62e9\u65f6\u95f4",dateFormat:"yyyy/MM/dd HH:mm"}}},submitAction:n=>(n.timestamp=String(new Date((0,d.p6)(n.date,"yyyy/MM/dd HH:mm:ss")).getTime()),delete n.date,o?.id?this.todoSrv.updateToDo(n).pipe((0,m.U)(s=>("SUCCESS"==s.result&&this.setToDoListArray(s.data),s.result))):this.todoSrv.addToDo(n).pipe((0,m.U)(s=>("SUCCESS"==s.result&&this.setToDoListArray(s.data),s.result)))),onClose:()=>{this.editing=!1}})}changeStatus(o){this.todoSrv.updateToDo({id:o.id,status:"checked"==o.status?"default":"checked"}).subscribe(s=>{this.setToDoListArray(s.data)})}onItemMouseUp(o,i){2==o.button&&this.EMS.create({menu:[{name:"\u7f16\u8f91",click:()=>{this.editToDo(i)}},{name:"\u5220\u9664",click:()=>{this.modalSrv.confirm({title:"\u786e\u8ba4\u5220\u9664\u6b64\u5f85\u529e\u4e8b\u9879\u5417\uff1f",content:"\u6b64\u64cd\u4f5c\u4e0d\u80fd\u6062\u590d",confirmAction:()=>{this.todoSrv.deleteToDo(i).subscribe(s=>{this.setToDoListArray(s.data)})}})}}]},[o.x,o.y])}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(f.y),t.Y36(M.Z),t.Y36(h._),t.Y36(C.d))},e.\u0275cmp=t.Xpm({type:e,selectors:[["ng-component"]],decls:2,vars:2,consts:[[3,"titleBarConfig"],["class","to-do full-parent-scroll p-md",4,"ngIf"],[1,"to-do","full-parent-scroll","p-md"],[1,"main-title","mb-lg","flex-row","justify-between"],["e-icon","","icon","add_circle","size","medium",3,"click"],["class","empty","text","\u6682\u65e0\u5f85\u529e\u4e8b\u9879",4,"ngIf"],["class","to-do-group",4,"ngFor","ngForOf"],["text","\u6682\u65e0\u5f85\u529e\u4e8b\u9879",1,"empty"],[1,"to-do-group"],[1,"group-title","mt-lg","mb-md","pl-sm"],["class","to-do-item flex-row align-center mb-sm px-sm py-md",3,"ngClass","click","mouseup",4,"ngFor","ngForOf"],[1,"to-do-item","flex-row","align-center","mb-sm","px-sm","py-md",3,"ngClass","click","mouseup"],["e-icon","","size","small","type","outlined",1,"check-icon","mr-sm",3,"icon","click"],[1,"detail"],[1,"title"],[1,"date"]],template:function(o,i){1&o&&(t.TgZ(0,"e-app",0),t.YNc(1,y,7,2,"div",1),t.qZA()),2&o&&(t.Q6J("titleBarConfig",i.titleBarConfig),t.xp6(1),t.Q6J("ngIf",i.toDoListArray))},dependencies:[a.mk,a.sg,a.O5,D.T,O.S,T.S,P.T],styles:['@charset "UTF-8";.to-do[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{height:200px}.to-do[_ngcontent-%COMP%]   .main-title[_ngcontent-%COMP%]   b[_ngcontent-%COMP%], .to-do[_ngcontent-%COMP%]   .main-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#2064d8}.to-do[_ngcontent-%COMP%]   .main-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .2s,filter .2s}.to-do[_ngcontent-%COMP%]   .main-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{filter:brightness(130%)}.to-do[_ngcontent-%COMP%]   .main-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:active{transform:scale(.9)}.to-do[_ngcontent-%COMP%]   .to-do-item[_ngcontent-%COMP%]{position:relative;border:solid #eaeaea 1px;border-radius:4px;background-color:#fff;transition:box-shadow .4s ease}.to-do[_ngcontent-%COMP%]   .to-do-item[_ngcontent-%COMP%]:hover{box-shadow:0 2px 4px -2px #0000001f,0 2px 8px #00000014}.to-do[_ngcontent-%COMP%]   .to-do-item[_ngcontent-%COMP%]:active{box-shadow:none}.to-do[_ngcontent-%COMP%]   .to-do-item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-bottom:2.6666666667px}.to-do[_ngcontent-%COMP%]   .to-do-item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{font-size:12px;color:#a5adba}.to-do[_ngcontent-%COMP%]   .to-do-item.checked[_ngcontent-%COMP%]{opacity:.5}.to-do[_ngcontent-%COMP%]   .to-do-item.checked[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-decoration:line-through}.to-do[_ngcontent-%COMP%]   .to-do-item.expired[_ngcontent-%COMP%]:before{content:"\\5df2\\8fc7\\671f";background-color:#0052cc;position:absolute;right:-4px;top:2px;color:#fff;font-size:12px;padding:0 3px;line-height:18px;border-radius:2px;transform:rotate(10deg)}']}),e})(),L=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.m]}),e})()}}]);